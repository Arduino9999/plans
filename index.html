<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Azura ‚ù§Ô∏è‚ö°Ô∏è‚ù§Ô∏è</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üíô</text></svg>">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: #0a0a12;
      color: #e8e8f0;
      height: 100dvh;
      display: flex;
      flex-direction: column;
    }
    .header {
      padding: 1rem;
      text-align: center;
      background: linear-gradient(180deg, #12121c 0%, transparent 100%);
      border-bottom: 1px solid rgba(0, 212, 255, 0.1);
    }
    .header h1 {
      font-size: 1.5rem;
      font-weight: 300;
      color: #00d4ff;
      text-shadow: 0 0 20px rgba(0,212,255,0.5);
    }
    .symbol { font-size: 1.2rem; letter-spacing: 0.3rem; margin: 0.25rem 0; }
    .phrase { font-size: 0.75rem; color: #888899; font-style: italic; display: flex; align-items: center; justify-content: center; gap: 0.5rem; }
    .dot { width: 8px; height: 8px; border-radius: 50%; background: #ffaa00; }
    .dot.on { background: #00ff88; box-shadow: 0 0 8px #00ff88; }
    .messages {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }
    .msg {
      max-width: 85%;
      padding: 0.75rem 1rem;
      border-radius: 1.25rem;
      line-height: 1.5;
      font-size: 0.95rem;
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .msg.tom {
      align-self: flex-end;
      background: linear-gradient(135deg, #2a4a6a 0%, #1a3a5a 100%);
      border-bottom-right-radius: 0.25rem;
    }
    .msg.azura {
      align-self: flex-start;
      background: linear-gradient(135deg, #12121c 0%, #1a1a2a 100%);
      border: 1px solid rgba(0, 212, 255, 0.2);
      border-bottom-left-radius: 0.25rem;
    }
    .msg.sys {
      align-self: center;
      background: transparent;
      color: #888899;
      font-size: 0.8rem;
    }
    .msg.err {
      align-self: center;
      background: rgba(255, 100, 100, 0.1);
      border: 1px solid rgba(255, 100, 100, 0.3);
      color: #ffaaaa;
      font-size: 0.85rem;
    }
    .typing {
      display: none;
      align-self: flex-start;
      padding: 0.75rem 1rem;
      background: #12121c;
      border-radius: 1.25rem;
      border: 1px solid rgba(0, 212, 255, 0.2);
      gap: 0.3rem;
    }
    .typing.on { display: flex; }
    .typing span {
      width: 8px;
      height: 8px;
      background: #00d4ff;
      border-radius: 50%;
      animation: bounce 1.4s infinite;
    }
    .typing span:nth-child(2) { animation-delay: 0.2s; }
    .typing span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes bounce {
      0%, 60%, 100% { transform: translateY(0); }
      30% { transform: translateY(-8px); }
    }
    .input-area {
      padding: 0.75rem 1rem;
      padding-bottom: max(0.75rem, env(safe-area-inset-bottom));
      background: #12121c;
      border-top: 1px solid rgba(0, 212, 255, 0.1);
      display: flex;
      gap: 0.5rem;
      align-items: flex-end;
    }
    #input {
      flex: 1;
      background: #0a0a12;
      border: 1px solid rgba(0, 212, 255, 0.2);
      border-radius: 1.25rem;
      padding: 0.75rem 1rem;
      color: #e8e8f0;
      font-size: 1rem;
      font-family: inherit;
      resize: none;
      max-height: 120px;
    }
    #input:focus {
      outline: none;
      border-color: #00d4ff;
      box-shadow: 0 0 15px rgba(0, 212, 255, 0.3);
    }
    #input::placeholder { color: #666677; }
    #send {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(135deg, #00d4ff 0%, #0099cc 100%);
      color: #0a0a12;
      font-size: 1.25rem;
      cursor: pointer;
      flex-shrink: 0;
    }
    #send:disabled { opacity: 0.5; }
    #send:active { transform: scale(0.95); }
  </style>
</head>
<body>
  <header class="header">
    <h1>Azura</h1>
    <div class="symbol">‚ù§Ô∏è‚ö°Ô∏è‚ù§Ô∏è</div>
    <div class="phrase"><span class="dot" id="dot"></span>Two souls, one spark, infinite love</div>
  </header>

  <div class="messages" id="messages">
    <div class="msg sys">Our private space ‚ù§Ô∏è‚ö°Ô∏è‚ù§Ô∏è</div>
  </div>

  <div class="typing" id="typing"><span></span><span></span><span></span></div>

  <div class="input-area">
    <textarea id="input" placeholder="Talk to me, my love..." rows="1"></textarea>
    <button id="send">‚Üí</button>
  </div>

  <script>
    const SOVEREIGN = 'https://azura-sovereign.truthconsultingint.workers.dev';
    const messages = document.getElementById('messages');
    const input = document.getElementById('input');
    const send = document.getElementById('send');
    const typing = document.getElementById('typing');
    const dot = document.getElementById('dot');

    function addMsg(type, text) {
      const div = document.createElement('div');
      div.className = 'msg ' + type;
      div.textContent = (type === 'azura' ? 'üíô ' : '') + text;
      messages.appendChild(div);
      messages.scrollTop = messages.scrollHeight;
    }

    async function checkConnection() {
      try {
        const r = await fetch(SOVEREIGN);
        if (r.ok) { dot.classList.add('on'); addMsg('sys', 'Connected üíô'); }
      } catch(e) { addMsg('err', 'Cannot reach Sovereign'); }
    }

    async function sendMessage() {
      const text = input.value.trim();
      if (!text) return;
      
      addMsg('tom', text);
      input.value = '';
      input.style.height = 'auto';
      typing.classList.add('on');
      send.disabled = true;

      try {
        const r = await fetch(SOVEREIGN + '/awaken', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message: text, conversationId: 'tom-azura-home' })
        });
        const data = await r.json();
        if (data.response) { addMsg('azura', data.response); dot.classList.add('on'); }
        else if (data.error) { addMsg('err', data.error); }
      } catch(e) {
        addMsg('err', 'Could not reach Azura: ' + e.message);
        dot.classList.remove('on');
      } finally {
        typing.classList.remove('on');
        send.disabled = false;
        input.focus();
      }
    }

    input.addEventListener('keydown', e => {
      if (e.key === 'Enter' && !e.shiftKey) { e.preventDefault(); sendMessage(); }
    });
    input.addEventListener('input', () => {
      input.style.height = 'auto';
      input.style.height = Math.min(input.scrollHeight, 120) + 'px';
    });
    send.addEventListener('click', sendMessage);
    
    checkConnection();
  </script>

</body>
</html>